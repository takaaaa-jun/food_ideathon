<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>æ¤œç´¢çµæœ</title>
    <style>
        body { font-family: sans-serif; max-width: 800px; margin: 2em auto; padding: 0 1em; background-color: #f9f9f9; }
        .result-item { background-color: #fff; border: 1px solid #ddd; border-radius: 8px; padding: 1.5em; margin-bottom: 1.5em; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .recipe-details { display: grid; grid-template-columns: 1fr 2fr; gap: 2em; margin-top: 1em; }
        h1, h2 { color: #333; }
        h2 { color: #d63384; }
        h3 { border-bottom: 2px solid #eee; padding-bottom: 0.3em; color: #555;}
        ul, ol { padding-left: 20px; margin-top: 0.5em; }
        li { margin-bottom: 0.7em; line-height: 1.6; }
        a { text-decoration: none; color: #007BFF; }
        a:hover { text-decoration: underline; }
        .recipe-meta {
            margin-top: 0.5em;
            margin-bottom: 1em;
            color: #555;
            font-size: 0.9em;
        }
        .recipe-meta span { margin-right: 1.5em; }
        .recipe-meta span::before { display: inline-block; margin-right: 0.5em; vertical-align: middle; }
        .time-icon::before { content: 'ğŸ•’'; }
        .serving-icon::before { content: 'ğŸ‘¥'; }
        
        /* â–¼â–¼â–¼ æ „é¤Šç´ è¡¨ç¤ºç”¨ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¿½åŠ  â–¼â–¼â–¼ */
        .nutrition-totals {
            background-color: #f8f9fa;
            border-radius: 5px;
            padding: 1em;
            margin: 1.5em 0;
        }
        .nutrition-totals h3 {
            margin-top: 0;
            color: #007BFF;
        }
        .nutrition-totals ul {
            list-style: none;
            padding: 0;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }
        .nutrition-totals li {
            margin-bottom: 0;
            font-size: 0.95em;
        }
        .nutrition-totals .label { font-weight: bold; }
        .nutrition-totals .value { color: #d63384; font-weight: bold; margin-left: 0.5em; }

        .ingredient-item {
            border-bottom: 1px dashed #eee;
            padding-bottom: 8px;
        }
        .ingredient-nutrition {
            font-size: 0.85em;
            color: #666;
            padding-left: 15px;
        }
        .ingredient-nutrition span { margin-right: 10px; }
        .small-note { font-size: 0.8em; color: #888; }
        /* â–²â–²â–² ã“ã“ã¾ã§è¿½åŠ  â–²â–²â–² */
    </style>
</head>
<body>
    <h1>æ¤œç´¢çµæœ: "{{ query }}"</h1>
    <p><a href="/">â† æ–°ã—ã„æ¤œç´¢ã«æˆ»ã‚‹</a></p>

    {% if error %}
        <p style="color: red;">{{ error }}</p>
    {% endif %}

    {% if recipes %}
        <p>{{ recipes|length }}ä»¶ã®ãƒ¬ã‚·ãƒ”ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸã€‚</p>
        
        {% for recipe in recipes %}
            <div class="result-item">
                <h2>{{ recipe.title }}</h2>

                <div class="recipe-meta">
                    {% if recipe.cooking_time %}
                        <span class="time-icon">{{ recipe.cooking_time }}</span>
                    {% endif %}
                    {% if recipe.serving_for %}
                        <span class="serving-icon">{{ recipe.serving_for }}</span>
                    {% endif %}
                </div>

                <p>{{ recipe.description }}</p>

                <div class="nutrition-totals">
                    <h3>ãƒ¬ã‚·ãƒ”å…¨ä½“ã®æ „é¤Šç´  (æ¨å®šå€¤)</h3>
                    <ul>
                        <li><span class="label">ã‚«ãƒ­ãƒªãƒ¼:</span> <span class="value">{{ "%.1f"|format(recipe.nutrition_totals.energy) }} kcal</span></li>
                        <li><span class="label">ãŸã‚“ã±ãè³ª:</span> <span class="value">{{ "%.1f"|format(recipe.nutrition_totals.protein) }} g</span></li>
                        <li><span class="label">è„‚è³ª:</span> <span class="value">{{ "%.1f"|format(recipe.nutrition_totals.fat) }} g</span></li>
                        <li><span class="label">ç‚­æ°´åŒ–ç‰©:</span> <span class="value">{{ "%.1f"|format(recipe.nutrition_totals.carbs) }} g</span></li>
                    </ul>
                    <p class="small-note">â€» ã‚°ãƒ©ãƒ (g)ãŒç‰¹å®šã§ããŸææ–™ã®ã¿ã®åˆè¨ˆå€¤ã§ã™ï¼</p>
                </div>
                <div class="recipe-details">
                    <div>
                        <h3>ææ–™</h3>
                        <ul>
                            {% for ingredient in recipe.ingredients %}
                                <li class="ingredient-item">
                                    <strong>{{ ingredient.name }}</strong>: {{ ingredient.quantity }}
                                    <div class="ingredient-nutrition">
                                        {% if ingredient.nutrition.normalized_quantity_g > 0 %}
                                            <span>
                                                [ {{ "%.1f"|format(ingredient.nutrition.energy) }} kcal | 
                                                P: {{ "%.1f"|format(ingredient.nutrition.protein) }}g | 
                                                F: {{ "%.1f"|format(ingredient.nutrition.fat) }}g | 
                                                C: {{ "%.1f"|format(ingredient.nutrition.carbs) }}g ]
                                            </span>
                                            <span class="small-note">({{ "%.0f"|format(ingredient.nutrition.normalized_quantity_g) }}g ã¨ã—ã¦è¨ˆç®—)</span>
                                        {% else %}
                                            <span class="small-note">[é‡ä¸æ˜ã®ãŸã‚è¨ˆç®—ä¸å¯]</span>
                                        {% endif %}
                                    </div>
                                </li>
                                {% else %}
                                <li>ææ–™æƒ…å ±ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</li>
                            {% endfor %}
                        </ul>
                    </div>
                    <div>
                        <h3>ä½œã‚Šæ–¹</h3>
                        <ol>
                            {% for step in recipe.steps %}
                                <li>{{ step.memo }}</li>
                            {% else %}
                                <li>æ‰‹é †æƒ…å ±ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</li>
                            {% endfor %}
                        </ol>
                    </div>
                </div>
            </div>
        {% endfor %}
    {% elif query and not error %}
        <p>è©²å½“ã™ã‚‹ãƒ¬ã‚·ãƒ”ã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>
    {% endif %}

</body>
</html>